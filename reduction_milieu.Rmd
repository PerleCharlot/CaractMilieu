---
title: "Réduction des variables du milieu"
author: "Perle Charlot"
date: "Création : 01/08/2022"
output: 
  html_document:
    toc: TRUE
    toc_depth: 3
    keep_md: true
---

<style type="text/css">
.main-container {
  max-width: 100% !important;
  margin: auto;
}
</style>


```{r setup, include=FALSE}
#library(knitr)
knitr::opts_chunk$set(echo = TRUE)

# Espace de travail
wd <- getwd()
# Liste dimensions
liste.dim=  c("CA","B","PV","CS","D","I")

input_path <- paste0(wd,"/input/")
path_table_variables <- paste0(input_path,"/liste_variables.csv")

library(rmarkdown)
library(knitr)
library(data.table)
library(dplyr)
library(raster)
library(mapview)
library(leafsync)
library(RColorBrewer)
library(scales)
```

# Méthode de caractérisation du milieu

Nous pensons que l'environnement, sa structure, ses ressources et ses fonctions affectent l'organisation spatiale des usages en montagne.
```{r, echo=FALSE,out.width = "30%",dpi = 200,out.extra='style="float:right; padding:10px"'}
img1_path <- paste0(input_path,"/schéma_6_dimensions.png")
include_graphics(img1_path)
```

La théorie de la niche de Hutchinson, un hypervolume de n dimensions qui correspondent aux exigences d’une espèce pour survivre (Hutchinson, 1957), a été de nombreuses fois adaptée en définissant différemment les axes ou les entités étudiées (Blonder 2017). 
Nous appliquons ce concept pour caractériser le milieu en dimensions décrivant les différents types de ressources fournies par chaque unité spatiale, qui correspondent aux processus qui ont lieu et à leurs résultantes. Notre hypothèse est que parmi ces ressources, certaines sont des facteurs explicatifs à la présence des usages.
En nous inspirant de la biogéographie, qui décrit le rôle des facteurs biotiques, abiotiques et de la dispersion dans la distribution spatiale des espèces, tout en veillant à considérer l’anthropisation de l’environnement, ainsi que son aspect dynamique, notre cadre d’analyse décompose les ressources spatiales en six dimensions majeures : biomasse, structure de la végétation, conditions abiotiques, contexte spatial, dynamique et infrastructures humaines.
Chaque dimension est décomposée en caractéristiques, elles-mêmes approchées par des variables. Au total, c’est plus d’une quarantaine de variables qui sont calculées pour décrire cet espace à 6 dimensions.

L'objectif est ensuite de repérer où se situent les différents usages au sein de cet espace fonctionnel  multidimensionnel.


<!-- # Analyse factorielle par dimension {.tabset} -->

<!-- On utilise des **AFDM** (**Analyse Factorielle des Données Mixtes**, ou FAMD Factor Analysis for Mixed Data en anglais) pour traiter notre jeu de données car il contient des variables quantitatives et qualitatives. L'AFDM procède de la même manière qu'une ACP (Analyse en Composantes Principales) sur les variables quantitatives, et performe une ACM (Analyses des Correspondances Multiples) sur les variables qualitatives. -->

<!-- ## **Conditions Abiotiques** -->

<!-- Cette dimension décrit les conditions abiotiques, donc les caractéristiques associées au pixel qui ne sont pas dépendantes des êtres vivants. Elle est déclinée en 3 catégories : le climat, la topographie et l'hydrologie. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- dimension = liste.dim[1] -->
<!-- tout = list.files(recursive = T, paste0(wd,"/output/ACP/",dimension,"/"), full.names = T) -->
<!-- # exclure ACP -->
<!-- # tout <- tout[-grep("avec_ACP_clim",tout)] -->
<!-- table_variables <- fread(path_table_variables, header=T) -->
<!-- ```  -->


<!-- |`        Mai          `|`          Juin         `|`          Juillet           `|`          Août          `|`          Septembre    `| -->
<!-- |----|----|----|----|----| -->
<!-- |` `|` `|` `|` `|` `| -->

<!-- Pourcentage de variance expliqué par les 3 premiers axes de l'AFDM (ou 2 premiers axes si la dimension analysée est composée de moins de 3 variables). -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- eboulis = tout[grep("eboulis_variance",tout)] -->

<!-- include_graphics(c(eboulis[grep("mai",eboulis)],eboulis[grep("juin",eboulis)], -->
<!--                    eboulis[grep("juillet",eboulis)],eboulis[grep("aout",eboulis)], -->
<!--                    eboulis[grep("septembre",eboulis)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 1** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C1 = tout[grep("contrib_axe1",tout)] -->
<!-- include_graphics(c(C1[grep("mai",C1)],C1[grep("juin",C1)], -->
<!--                    C1[grep("juillet",C1)],C1[grep("aout",C1)], -->
<!--                    C1[grep("septembre",C1)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 2** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C2 = tout[grep("contrib_axe2",tout)] -->
<!-- include_graphics(c(C2[grep("mai",C2)],C2[grep("juin",C2)], -->
<!--                    C2[grep("juillet",C2)],C2[grep("aout",C2)], -->
<!--                    C2[grep("septembre",C2)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 3** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C3 = tout[grep("contrib_axe3",tout)] -->
<!-- include_graphics(c(C3[grep("mai",C3)],C3[grep("juin",C3)], -->
<!--                    C3[grep("juillet",C3)],C3[grep("aout",C3)], -->
<!--                    C3[grep("septembre",C3)])) -->
<!-- ```  -->

<!-- Distribution des pixels sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DI = tout[grep("graph_ind",tout)] -->
<!-- include_graphics(c(DI[grep("mai",DI)],DI[grep("juin",DI)], -->
<!--                    DI[grep("juillet",DI)],DI[grep("aout",DI)], -->
<!--                    DI[grep("septembre",DI)])) -->
<!-- ```  -->

<!-- Distribution des variables **quantitatives** sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quanti_axes1_2",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Distribution des variables **quantitatives** sur l'axe 2 et l'axe 3. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quanti_axes2_3",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Distribution des variables **qualitatives** sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quali_axes1_2",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Distribution des variables **qualitatives** sur l'axe 2 et l'axe 3. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quali_axes2_3",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- ### Interprétation des axes :   -->

<!-- * Axe 1 : décrit par les variables climatiques.  -->
<!-- Il représente des pixels aux températures basses, avec peu de nébulosité, ventés, enneigés, secs et gelés . On peut ici y lire un effet de l'altitude : ces caractéristiques sont liées à une augmentation de l'altitude. -->
<!-- Cette hypothèse est vérifiée par la visualisation cartographique de l'axe 1 : ce sont bien des pixels d'altitude qui ont les valeurs les plus élevées (valeur dans l'axe d'ACP). -->
<!-- * Axe 1 : corrélé + = landform 10, 7 et 3; corrélé - = landform 8, 4 et 1. A REGARDER   -->

<!-- ```{r, echo=FALSE,out.width="100%",fig.show='hold',message=FALSE,warning=FALSE} -->
<!-- paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/CA/"),'.tif$',full.names = T,recursive=TRUE) -->

<!-- paths_rast_ACP_axe1 = paths_rast_ACP[grep("axe1_",paths_rast_ACP)] -->
<!-- mapviewOptions(na.color = "transparent", -->
<!--                basemaps="OpenStreetMap", -->
<!--                viewer.suppress=TRUE, -->
<!--                trim=TRUE) -->
<!-- r1 <- raster(paths_rast_ACP_axe1[grep("mai",paths_rast_ACP_axe1)]) -->
<!-- m1 <- mapview(r1,layer.name="Axe 1 - Mai",col.regions=brewer.pal(5,"Blues")) -->
<!-- r2 <- raster(paths_rast_ACP_axe1[grep("juin",paths_rast_ACP_axe1)]) -->
<!-- m2 <- mapview(r2,layer.name="Axe 1 - Juin",col.regions=brewer.pal(5,"Blues")) -->
<!-- r3 <- raster(paths_rast_ACP_axe1[grep("juillet",paths_rast_ACP_axe1)]) -->
<!-- m3 <- mapview(r3,layer.name="Axe 1 - Juillet",col.regions=brewer.pal(5,"Blues")) -->
<!-- r4 <- raster(paths_rast_ACP_axe1[grep("aout",paths_rast_ACP_axe1)]) -->
<!-- m4 <- mapview(r4,layer.name="Axe 1 - Aout",col.regions=brewer.pal(5,"Blues")) -->
<!-- r5 <- raster(paths_rast_ACP_axe1[grep("septembre",paths_rast_ACP_axe1)]) -->
<!-- m5 <- mapview(r5,layer.name="Axe 1 - Septembre",col.regions=brewer.pal(5,"Blues")) -->

<!-- ## view different aspects of same data set -->
<!-- leafsync::sync(m1, m2, m3, m4, m5, ncol=5) -->
<!-- ``` -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->

<!-- * Axe 2 : décrit par les variables topographiques.   -->
<!-- Il représente des pixels pentus, avec une diversité de reliefs élevée, ESATING POSITIF = ?? face est ou ouest ? -->
<!-- avec un potentiel hydrique faible et peu de rayonnement. Ici, le contraste se fait donc plus sur l'inclinaison du terrain, ce qui est confirmé visualisation cartographique (valeurs faibles pour les zones plates et élevées pour les crêtes).   -->
<!-- * Axe 2 : corrélé + = landform 8; corrélé - = présence d'eau,landform 5.   -->

<!-- ```{r, echo=FALSE,out.width="20%",fig.show='hold',message=FALSE,warning=FALSE} -->
<!-- paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/CA/"),'.tif$',full.names = T,recursive=TRUE) -->

<!-- paths_rast_ACP_axe = paths_rast_ACP[grep("axe2_",paths_rast_ACP)] -->
<!-- mapviewOptions(na.color = "transparent", -->
<!--                basemaps="OpenStreetMap", -->
<!--                viewer.suppress=TRUE, -->
<!--                trim=TRUE) -->
<!-- r1 <- raster(paths_rast_ACP_axe[grep("mai",paths_rast_ACP_axe)]) -->
<!-- m1 <- mapview(r1,layer.name="Axe 2 - Mai",col.regions=brewer.pal(5,"Blues")) -->
<!-- r2 <- raster(paths_rast_ACP_axe[grep("juin",paths_rast_ACP_axe)]) -->
<!-- m2 <- mapview(r2,layer.name="Axe 2 - Juin",col.regions=brewer.pal(5,"Blues")) -->
<!-- r3 <- raster(paths_rast_ACP_axe[grep("juillet",paths_rast_ACP_axe)]) -->
<!-- m3 <- mapview(r3,layer.name="Axe 2 - Juillet",col.regions=brewer.pal(5,"Blues")) -->
<!-- r4 <- raster(paths_rast_ACP_axe[grep("aout",paths_rast_ACP_axe)]) -->
<!-- m4 <- mapview(r4,layer.name="Axe 2 - Aout",col.regions=brewer.pal(5,"Blues")) -->
<!-- r5 <- raster(paths_rast_ACP_axe[grep("septembre",paths_rast_ACP_axe)]) -->
<!-- m5 <- mapview(r5,layer.name="Axe 2 - Septembre",col.regions=brewer.pal(5,"Blues")) -->

<!-- ## view different aspects of same data set -->
<!-- leafsync::sync(m1, m2, m3, m4, m5, ncol=5) -->
<!-- ``` -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->

<!-- * Axe 3 : rayonnement + et pente nord/sud - (vérifier à quoi ça correspond, mais intuition que c'est sud). On a donc un effet thermique; l'axe représente des pixels un peu plus chauds. -->
<!-- * Axe 3 : corrélé + = landform 5 + présence eau; corrélé - = landform 10 -->

<!-- Variation au cours du temps :   -->
<!-- Durant les mois de juin, juillet et août, quelques variables climatiques prennent du poids dans l'axe 2 : neige, gel et pluie, qui sont corrélés négativement. Cela correspond à des pixels d'altitude élevée. A COGITER -->
<!-- Axe 3 : corrélation northing et rayonnement s'inversent en juillet/août (devient + et -, respectivement). ?? A COGITER -->
<!-- VARS QUALI : Inversion sur l'axe 3 en juillet + août. -->

<!-- ### Tableau récapitulatif des variables utilisée dans la dimension : -->
<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- table_output <- table_variables %>%  -->
<!--   subset(Dimension == dimension)  -->

<!-- kable(table_output) -->

<!-- ```  -->

<!-- ## **Conditions Abiotiques avec ACP sur variables climatiques** -->

<!-- Cette dimension décrit les conditions abiotiques, donc les caractéristiques associées au pixel qui ne sont pas dépendantes des êtres vivants. Elle est déclinée en 3 catégories : le climat, la topographie et l'hydrologie. -->

<!-- Les variables climatiques, très corrélées entre elles, ont été réduites en 2 variables via une ACP. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- dimension = liste.dim[1] -->
<!-- tout = list.files(recursive = T, paste0(wd,"/output/ACP/",dimension,"/avec_ACP_clim/"), full.names = T) -->
<!-- table_variables <- fread(path_table_variables, header=T) -->
<!-- ```  -->


<!-- |`        Mai          `|`          Juin         `|`          Juillet           `|`          Août          `|`          Septembre    `| -->
<!-- |----|----|----|----|----| -->
<!-- |` `|` `|` `|` `|` `| -->

<!-- Pourcentage de variance expliqué par les 3 premiers axes de l'AFDM (ou 2 premiers axes si la dimension analysée est composée de moins de 3 variables). -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- eboulis = tout[grep("eboulis_variance",tout)] -->

<!-- include_graphics(c(eboulis[grep("mai",eboulis)],eboulis[grep("juin",eboulis)], -->
<!--                    eboulis[grep("juillet",eboulis)],eboulis[grep("aout",eboulis)], -->
<!--                    eboulis[grep("septembre",eboulis)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 1** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C1 = tout[grep("contrib_axe1",tout)] -->
<!-- include_graphics(c(C1[grep("mai",C1)],C1[grep("juin",C1)], -->
<!--                    C1[grep("juillet",C1)],C1[grep("aout",C1)], -->
<!--                    C1[grep("septembre",C1)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 2** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C2 = tout[grep("contrib_axe2",tout)] -->
<!-- include_graphics(c(C2[grep("mai",C2)],C2[grep("juin",C2)], -->
<!--                    C2[grep("juillet",C2)],C2[grep("aout",C2)], -->
<!--                    C2[grep("septembre",C2)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 3** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C3 = tout[grep("contrib_axe3",tout)] -->
<!-- include_graphics(c(C3[grep("mai",C3)],C3[grep("juin",C3)], -->
<!--                    C3[grep("juillet",C3)],C3[grep("aout",C3)], -->
<!--                    C3[grep("septembre",C3)])) -->
<!-- ```  -->

<!-- Distribution des pixels sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DI = tout[grep("graph_ind",tout)] -->
<!-- include_graphics(c(DI[grep("mai",DI)],DI[grep("juin",DI)], -->
<!--                    DI[grep("juillet",DI)],DI[grep("aout",DI)], -->
<!--                    DI[grep("septembre",DI)])) -->
<!-- ```  -->

<!-- Distribution des variables sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Tableau récapitulatif des variables utilisée dans la dimension : -->
<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- table_output <- table_variables %>%  -->
<!--   subset(Dimension == dimension)  -->

<!-- kable(table_output) -->

<!-- ```  -->

<!-- ## **Biomasse** -->
<!-- La biomasse du pixel correspond à la production de la biocénose qui est directement utilisée lors d’un usage e.g. pour une consommation alimentaire (fourrage, fruits, insectes, poissons) ou pour une utilisation commerciale (bois, charbon, pétrole) ou récréative (poissons). L’usage des différentes biomasses entraîne un prélèvement et/ou une destruction de celle-ci. -->
<!-- Cette dimension est déclinée en 3 catégories : quantité, qualité et productivité. -->
<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- dimension = liste.dim[2] -->
<!-- tout = list.files(recursive = T, paste0(wd,"/output/ACP/",dimension,"/"), full.names = T) -->
<!-- table_variables <- fread(path_table_variables, header=T) -->
<!-- ```  -->

<!-- |`        Mai          `|`          Juin         `|`          Juillet           `|`          Août          `|`          Septembre    `| -->
<!-- |----|----|----|----|----| -->
<!-- |` `|` `|` `|` `|` `| -->

<!-- Pourcentage de variance expliqué par les 3 premiers axes de l'AFDM (ou 2 premiers axes si la dimension analysée est composée de moins de 3 variables). -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- eboulis = tout[grep("eboulis_variance",tout)] -->

<!-- include_graphics(c(eboulis[grep("mai",eboulis)],eboulis[grep("juin",eboulis)], -->
<!--                    eboulis[grep("juillet",eboulis)],eboulis[grep("aout",eboulis)], -->
<!--                    eboulis[grep("septembre",eboulis)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 1** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C1 = tout[grep("contrib_axe1",tout)] -->
<!-- include_graphics(c(C1[grep("mai",C1)],C1[grep("juin",C1)], -->
<!--                    C1[grep("juillet",C1)],C1[grep("aout",C1)], -->
<!--                    C1[grep("septembre",C1)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 2** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C2 = tout[grep("contrib_axe2",tout)] -->
<!-- include_graphics(c(C2[grep("mai",C2)],C2[grep("juin",C2)], -->
<!--                    C2[grep("juillet",C2)],C2[grep("aout",C2)], -->
<!--                    C2[grep("septembre",C2)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 3** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C3 = tout[grep("contrib_axe3",tout)] -->
<!-- include_graphics(c(C3[grep("mai",C3)],C3[grep("juin",C3)], -->
<!--                    C3[grep("juillet",C3)],C3[grep("aout",C3)], -->
<!--                    C3[grep("septembre",C3)])) -->
<!-- ```  -->

<!-- Distribution des pixels sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DI = tout[grep("graph_ind",tout)] -->
<!-- include_graphics(c(DI[grep("mai",DI)],DI[grep("juin",DI)], -->
<!--                    DI[grep("juillet",DI)],DI[grep("aout",DI)], -->
<!--                    DI[grep("septembre",DI)])) -->
<!-- ```  -->

<!-- Distribution des variables **quantitatives** sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quanti_axes1_2",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Distribution des variables **quantitatives** sur l'axe 2 et l'axe 3. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quanti_axes2_3",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Distribution des variables **qualitatives** sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quali_axes1_2",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Distribution des variables **qualitatives** sur l'axe 2 et l'axe 3. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quali_axes2_3",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->


<!-- Interprétation des axes :   -->

<!-- * Axe 1 : Cela correspond à des pixels productifs en végétation (bilan hydrique fort et biomasse abondante), donc aux forêts d'altitude plus basse. -->
<!-- * Axe 2 : + = abondance feuillage 3; - = feuillage 0. Avec la carto on dirait que ce sont les patchs de landes qui ressortent (forêt et hautes altitudes ont des valeurs faibles). -->
<!-- * Axe 3 : inverse de axe 2. -->

<!-- Variation au cours du temps :   -->
<!-- * Axe 1 : inversion en juillet et août du bilan hydrique, qui devient corrélé négativement. Sur la visualisation carto, on remarque que les valeurs élevées dans l'axe ne persistent que dans les altitudes les plus basses  -> plus basses donc plus sèches ? -->

<!-- Conclusion : -->
<!-- Ne garder que les 2 premiers axes. -->

<!-- Tableau récapitulatif des variables utilisée dans la dimension : -->
<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- table_output <- table_variables %>%  -->
<!--   subset(Dimension == dimension)  -->

<!-- kable(table_output) -->

<!-- ```  -->

<!-- ## **Physionomie de Végétation** -->
<!-- La physionomie, définie comme l’aspect général d’une végétation, est le deuxième type de ressource directement lié à la biocénose (végétation). On s'intéresse spécifiquement à la structure de la végétation. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- dimension = liste.dim[3] -->
<!-- tout = list.files(recursive = T, paste0(wd,"/output/ACP/",dimension,"/"), full.names = T) -->
<!-- table_variables <- fread(path_table_variables, header=T) -->
<!-- ```  -->

<!-- |`        Mai          `|`          Juin         `|`          Juillet           `|`          Août          `|`          Septembre    `| -->
<!-- |----|----|----|----|----| -->
<!-- |` `|` `|` `|` `|` `| -->
<!-- Pourcentage de variance expliqué par les 3 premiers axes de l'AFDM (ou 2 premiers axes si la dimension analysée est composée de moins de 3 variables). -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- eboulis = tout[grep("eboulis_variance",tout)] -->

<!-- include_graphics(c(eboulis[grep("mai",eboulis)],eboulis[grep("juin",eboulis)], -->
<!--                    eboulis[grep("juillet",eboulis)],eboulis[grep("aout",eboulis)], -->
<!--                    eboulis[grep("septembre",eboulis)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 1** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C1 = tout[grep("contrib_axe1",tout)] -->
<!-- include_graphics(c(C1[grep("mai",C1)],C1[grep("juin",C1)], -->
<!--                    C1[grep("juillet",C1)],C1[grep("aout",C1)], -->
<!--                    C1[grep("septembre",C1)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 2** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C2 = tout[grep("contrib_axe2",tout)] -->
<!-- include_graphics(c(C2[grep("mai",C2)],C2[grep("juin",C2)], -->
<!--                    C2[grep("juillet",C2)],C2[grep("aout",C2)], -->
<!--                    C2[grep("septembre",C2)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 3** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C3 = tout[grep("contrib_axe3",tout)] -->
<!-- include_graphics(c(C3[grep("mai",C3)],C3[grep("juin",C3)], -->
<!--                    C3[grep("juillet",C3)],C3[grep("aout",C3)], -->
<!--                    C3[grep("septembre",C3)])) -->
<!-- ```  -->

<!-- Distribution des pixels sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DI = tout[grep("graph_ind",tout)] -->
<!-- include_graphics(c(DI[grep("mai",DI)],DI[grep("juin",DI)], -->
<!--                    DI[grep("juillet",DI)],DI[grep("aout",DI)], -->
<!--                    DI[grep("septembre",DI)])) -->
<!-- ```  -->

<!-- Distribution des variables sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Interprétation des axes pour les variables quantitatives :   -->

<!-- * Axe 1 :  -->
<!-- * Axe 2 :  -->
<!-- * Axe 3 :  -->

<!-- Variation au cours du temps :  -->

<!-- Tableau récapitulatif des variables utilisée dans la dimension : -->
<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- table_output <- table_variables %>%  -->
<!--   subset(Dimension == dimension)  -->

<!-- kable(table_output) -->

<!-- ``` -->
<!-- ## **Contexte Spatial** -->
<!-- Le contexte spatial se rapporte aux éléments du voisinage proche et lointain du pixel étudié. Il est décliné sous 3 caractéristiques : l’accessibilité, la similarité et l’information visuelle. -->
<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- dimension = liste.dim[4] -->
<!-- tout = list.files(recursive = T, paste0(wd,"/output/ACP/",dimension,"/"), full.names = T) -->
<!-- table_variables <- fread(path_table_variables, header=T) -->
<!-- ```  -->

<!-- |`        Mai          `|`          Juin         `|`          Juillet           `|`          Août          `|`          Septembre    `| -->
<!-- |----|----|----|----|----| -->
<!-- |` `|` `|` `|` `|` `| -->
<!-- Pourcentage de variance expliqué par les 3 premiers axes de l'AFDM (ou 2 premiers axes si la dimension analysée est composée de moins de 3 variables). -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- eboulis = tout[grep("eboulis_variance",tout)] -->
<!-- include_graphics(c(eboulis[grep("mai",eboulis)],eboulis[grep("juin",eboulis)], -->
<!--                    eboulis[grep("juillet",eboulis)],eboulis[grep("aout",eboulis)], -->
<!--                    eboulis[grep("septembre",eboulis)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 1** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C1 = tout[grep("contrib_axe1",tout)] -->
<!-- include_graphics(c(C1[grep("mai",C1)],C1[grep("juin",C1)], -->
<!--                    C1[grep("juillet",C1)],C1[grep("aout",C1)], -->
<!--                    C1[grep("septembre",C1)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 2** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C2 = tout[grep("contrib_axe2",tout)] -->
<!-- include_graphics(c(C2[grep("mai",C2)],C2[grep("juin",C2)], -->
<!--                    C2[grep("juillet",C2)],C2[grep("aout",C2)], -->
<!--                    C2[grep("septembre",C2)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 3** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C3 = tout[grep("contrib_axe3",tout)] -->
<!-- include_graphics(c(C3[grep("mai",C3)],C3[grep("juin",C3)], -->
<!--                    C3[grep("juillet",C3)],C3[grep("aout",C3)], -->
<!--                    C3[grep("septembre",C3)])) -->
<!-- ```  -->

<!-- Distribution des pixels sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DI = tout[grep("graph_ind",tout)] -->
<!-- include_graphics(c(DI[grep("mai",DI)],DI[grep("juin",DI)], -->
<!--                    DI[grep("juillet",DI)],DI[grep("aout",DI)], -->
<!--                    DI[grep("septembre",DI)])) -->
<!-- ```  -->

<!-- Distribution des variables **quantitatives** sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_CS",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Distribution des variables **quantitatives** sur l'axe 2 et l'axe 3. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quanti_axes2_3",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- ### Interprétation des axes :   -->

<!-- * Axe 1 : pixels d'habitats similaires à leurs voisins, appartenant à de grands patchs, avec une visibilité faible -> milieux forestiers + falaises nord lac doménon.  -->
<!-- ```{r, echo=FALSE,out.width="100%",fig.show='hold',message=FALSE,warning=FALSE} -->
<!-- paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/CS/"),'.tif$',full.names = T,recursive=TRUE) -->

<!-- paths_rast_ACP_axe1 = paths_rast_ACP[grep("axe1_",paths_rast_ACP)] -->
<!-- mapviewOptions(na.color = "transparent", -->
<!--                basemaps="OpenStreetMap", -->
<!--                viewer.suppress=TRUE, -->
<!--                trim=TRUE) -->
<!-- r1 <- raster(paths_rast_ACP_axe1[grep("mai",paths_rast_ACP_axe1)]) -->
<!-- m1 <- mapview(r1,layer.name="Axe 1 - Mai",col.regions=brewer.pal(5,"Blues")) -->
<!-- r2 <- raster(paths_rast_ACP_axe1[grep("juin",paths_rast_ACP_axe1)]) -->
<!-- m2 <- mapview(r2,layer.name="Axe 1 - Juin",col.regions=brewer.pal(5,"Blues")) -->
<!-- r3 <- raster(paths_rast_ACP_axe1[grep("juillet",paths_rast_ACP_axe1)]) -->
<!-- m3 <- mapview(r3,layer.name="Axe 1 - Juillet",col.regions=brewer.pal(5,"Blues")) -->
<!-- r4 <- raster(paths_rast_ACP_axe1[grep("aout",paths_rast_ACP_axe1)]) -->
<!-- m4 <- mapview(r4,layer.name="Axe 1 - Aout",col.regions=brewer.pal(5,"Blues")) -->
<!-- r5 <- raster(paths_rast_ACP_axe1[grep("septembre",paths_rast_ACP_axe1)]) -->
<!-- m5 <- mapview(r5,layer.name="Axe 1 - Septembre",col.regions=brewer.pal(5,"Blues")) -->

<!-- ## view different aspects of same data set -->
<!-- leafsync::sync(m1, m2, m3, m4, m5, ncol=5) -->
<!-- ``` -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/>   -->
<!-- * Axe 2 : pixels éloignés des points d'entrée, des infrastructures et des forêts. Donc plutôt la partie est de la zone. -->
<!-- * Axe 3 : éloignés des lacs et rivières, avec une visibilité moyenne mais moyennement proche des infrastructures. -->

<!-- Variation au cours du temps :  -->
<!-- Aucune modification significative au cours du temps. -->

<!-- ### Tableau récapitulatif des variables utilisée dans la dimension : -->
<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- table_output <- table_variables %>%  -->
<!--   subset(Dimension == dimension)  -->

<!-- kable(table_output) -->

<!-- ``` -->
<!-- ## **Dynamique** -->
<!-- Cette dimension caractérise la trajectoire d'évolution sur laquelle le pixel se positionne. Cette évolution est décrite de façon climatique et par le régime de perturbation. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- dimension = liste.dim[5] -->
<!-- tout = list.files(recursive = T, paste0(wd,"/output/ACP/",dimension,"/"), full.names = T) -->
<!-- table_variables <- fread(path_table_variables, header=T) -->
<!-- ```  -->

<!-- |`        Mai          `|`          Juin         `|`          Juillet           `|`          Août          `|`          Septembre    `| -->
<!-- |----|----|----|----|----| -->
<!-- |` `|` `|` `|` `|` `| -->
<!-- Pourcentage de variance expliqué par les 3 premiers axes de l'AFDM (ou 2 premiers axes si la dimension analysée est composée de moins de 3 variables). -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- eboulis = tout[grep("eboulis_variance",tout)] -->
<!-- include_graphics(c(eboulis[grep("mai",eboulis)],eboulis[grep("juin",eboulis)], -->
<!--                    eboulis[grep("juillet",eboulis)],eboulis[grep("aout",eboulis)], -->
<!--                    eboulis[grep("septembre",eboulis)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 1** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C1 = tout[grep("contrib_axe1",tout)] -->
<!-- include_graphics(c(C1[grep("mai",C1)],C1[grep("juin",C1)], -->
<!--                    C1[grep("juillet",C1)],C1[grep("aout",C1)], -->
<!--                    C1[grep("septembre",C1)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 2** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C2 = tout[grep("contrib_axe2",tout)] -->
<!-- include_graphics(c(C2[grep("mai",C2)],C2[grep("juin",C2)], -->
<!--                    C2[grep("juillet",C2)],C2[grep("aout",C2)], -->
<!--                    C2[grep("septembre",C2)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 3** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C3 = tout[grep("contrib_axe3",tout)] -->
<!-- include_graphics(c(C3[grep("mai",C3)],C3[grep("juin",C3)], -->
<!--                    C3[grep("juillet",C3)],C3[grep("aout",C3)], -->
<!--                    C3[grep("septembre",C3)])) -->
<!-- ```  -->

<!-- Distribution des pixels sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DI = tout[grep("graph_ind",tout)] -->
<!-- include_graphics(c(DI[grep("mai",DI)],DI[grep("juin",DI)], -->
<!--                    DI[grep("juillet",DI)],DI[grep("aout",DI)], -->
<!--                    DI[grep("septembre",DI)])) -->
<!-- ```  -->

<!-- Distribution des variables sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_D",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Distribution des variables **qualitatives** sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quali_axes1_2",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Interprétation des axes pour les variables :   -->

<!-- * Axe 1 :  -->
<!-- * Axe 2 :  -->
<!-- * Axe 3 :  -->

<!-- Variation au cours du temps :  -->

<!-- Tableau récapitulatif des variables utilisée dans la dimension : -->
<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- table_output <- table_variables %>%  -->
<!--   subset(Dimension == dimension)  -->

<!-- kable(table_output) -->

<!-- ``` -->
<!-- ## **Infrastructures** -->
<!-- Les infrastructures humaines physiques et virtuelles sont considérées comme une ressource fournit par le pixel. Celles-ci sont déclinées en deux catégories : l'artificialisation du sol et la protection réglementaire. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- dimension = liste.dim[6] -->
<!-- tout = list.files(recursive = T, paste0(wd,"/output/ACP/",dimension,"/"), full.names = T) -->
<!-- table_variables <- fread(path_table_variables, header=T) -->
<!-- ```  -->

<!-- |`        Mai          `|`          Juin         `|`          Juillet           `|`          Août          `|`          Septembre    `| -->
<!-- |----|----|----|----|----| -->
<!-- |` `|` `|` `|` `|` `| -->

<!-- Pourcentage de variance expliqué par les 3 premiers axes de l'AFDM (ou 2 premiers axes si la dimension analysée est composée de moins de 3 variables). -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- eboulis = tout[grep("eboulis_variance",tout)] -->
<!-- include_graphics(c(eboulis[grep("mai",eboulis)],eboulis[grep("juin",eboulis)], -->
<!--                    eboulis[grep("juillet",eboulis)],eboulis[grep("aout",eboulis)], -->
<!--                    eboulis[grep("septembre",eboulis)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 1** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C1 = tout[grep("contrib_axe1",tout)] -->
<!-- include_graphics(c(C1[grep("mai",C1)],C1[grep("juin",C1)], -->
<!--                    C1[grep("juillet",C1)],C1[grep("aout",C1)], -->
<!--                    C1[grep("septembre",C1)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 2** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C2 = tout[grep("contrib_axe2",tout)] -->
<!-- include_graphics(c(C2[grep("mai",C2)],C2[grep("juin",C2)], -->
<!--                    C2[grep("juillet",C2)],C2[grep("aout",C2)], -->
<!--                    C2[grep("septembre",C2)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables de la dimension analysée pour l'**axe 3** de l'AFDM. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C3 = tout[grep("contrib_axe3",tout)] -->
<!-- include_graphics(c(C3[grep("mai",C3)],C3[grep("juin",C3)], -->
<!--                    C3[grep("juillet",C3)],C3[grep("aout",C3)], -->
<!--                    C3[grep("septembre",C3)])) -->
<!-- ```  -->

<!-- Distribution des pixels sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DI = tout[grep("graph_ind",tout)] -->
<!-- include_graphics(c(DI[grep("mai",DI)],DI[grep("juin",DI)], -->
<!--                    DI[grep("juillet",DI)],DI[grep("aout",DI)], -->
<!--                    DI[grep("septembre",DI)])) -->
<!-- ```  -->

<!-- Distribution des variables sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_I",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->


<!-- Distribution des variables **qualitatives** sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quali_axes1_2",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Distribution des variables **qualitatives** sur l'axe 2 et l'axe 3. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var_quali_axes2_3",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- Interprétation des axes :   -->

<!-- * Axe 1 : + degré artif 1 et 3, % infrastructure. Pixels artificialisés par des infrastructures (remontées mécaniques, refuge). -->
<!-- * Axe 2 : + degré interdiction 2 ; - degré artif 2. Pixels de zones protégées (CEN). -->
<!-- * Axe 3 : + degré artif 3. Ne discrimine quasiment rien. -->

<!-- Variation au cours du temps :   -->
<!-- Absence de variation. -->

<!-- Synthèse :   -->
<!-- Ne conserver que les 2 premiers axes. -->

<!-- Tableau récapitulatif des variables utilisée dans la dimension : -->
<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- table_output <- table_variables %>%  -->
<!--   subset(Dimension == dimension)  -->

<!-- kable(table_output) -->

<!-- ``` -->

# Analyse factorielle sur toutes les variables (sans considérer les dimensions) {.tabset}

Avec ACP sur variables climatiques.

## Graphiques
```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
tout = list.files(recursive = T, paste0(wd,"/output/ACP/toutes/"), full.names = T)
table_variables <- fread(path_table_variables, header=T)
``` 

|`        Mai          `|`          Juin         `|`          Juillet           `|`          Août          `|`          Septembre    `|
|----|----|----|----|----|
|` `|` `|` `|` `|` `|

Pourcentage de variance expliqué par les 3 premiers axes de l'AFDM.

```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
eboulis = tout[grep("eboulis_variance",tout)]
include_graphics(c(eboulis[grep("mai",eboulis)],eboulis[grep("juin",eboulis)],
                   eboulis[grep("juillet",eboulis)],eboulis[grep("aout",eboulis)],
                   eboulis[grep("septembre",eboulis)]))
``` 

Pourcentage de contribution des variables pour l'**axe 1** de l'AFDM.

```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
C1 = tout[grep("contrib_axe1",tout)]
include_graphics(c(C1[grep("mai",C1)],C1[grep("juin",C1)],
                   C1[grep("juillet",C1)],C1[grep("aout",C1)],
                   C1[grep("septembre",C1)]))
``` 

Pourcentage de contribution des variables pour l'**axe 2** de l'AFDM.

```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
C2 = tout[grep("contrib_axe2",tout)]
include_graphics(c(C2[grep("mai",C2)],C2[grep("juin",C2)],
                   C2[grep("juillet",C2)],C2[grep("aout",C2)],
                   C2[grep("septembre",C2)]))
``` 

Distribution des variables quantitatives sur l'axe 1 et l'axe 2.

```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
DV = tout[grep("graph_var_quanti_axes1_2",tout)]
include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)],
                   DV[grep("juillet",DV)],DV[grep("aout",DV)],
                   DV[grep("septembre",DV)]))
``` 

Distribution des variables qualitatives sur l'axe 1 et l'axe 2.

```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
DV = tout[grep("graph_var_quali_axes1_2",tout)]
include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)],
                   DV[grep("juillet",DV)],DV[grep("aout",DV)],
                   DV[grep("septembre",DV)]))
``` 

 Interprétation des axes :  

* Axe 1 : décrit en premier par des variables climatiques et de biomasse. 
Aux valeurs élevées de cet axe, on trouve des pixels ventés, enneigés, secs et gelés, qui sont situés sur des milieux ouverts qui peuvent être des sommets, des pentes supérieures ou des crêtes. 
Au contraire, les pixels présentant des valeurs faibles dans cet axe sont plus chauds, avec une nébulosité plus forte, et possèdent un bilan hydrique fort ainsi qu'une productivité en biomasse végétale élevée.  
Cet axe semble décrire un étagement altitudinal des pixels. Cette hypothèse est vérifiée par la visualisation cartographique : ce sont bien des pixels d'altitude qui ont les valeurs les plus élevées dans l'axe 1.

* Axe 2 : décrit principalement par des variables appartenant à la dimension contexte spatiale.
Aux valeurs élevées de cet axe, on trouve des pixels qui sont entourés par de nombreux pixels similaires et qui appartiennent à de grands patchs d'habitat identique. De plus, la strate basse de ces pixels est moyennement pénétrable (type sous bois) et le feuillage y est abondant. Le relief est plutôt plat, du type vallées en U.
Au contraire, les pixels présentant des valeurs faibles dans cet axe ont une strate basse peu pénétrable (type lande à éricacées), un feuillage moyennement abondant (type lande), une visibilité médiane forte et sont situés dans une zone protégée mais sans interdiction. De plus, ces pixels semblent plus subir le réchauffement climatique (moyenne de température 1989-2018 supérieure à moyenne 1959-1988).  
Il semblerait que cet axe distingue d'une part les pixels des centres de large patch d'habitat identique (forêt et pentes larges des crêtes les plus hautes, vers Doménon) et d'autre part les pixels de bordure de forêts, de zones ouvertes d'habitats morcelés, de landes mixtes.


```{r, echo=FALSE,out.width="100%",fig.show='hold',message=FALSE,warning=FALSE}
paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/toutes/"),'.tif$',full.names = T,recursive=TRUE)

paths_rast_ACP_axe1 = paths_rast_ACP[grep("axe1_",paths_rast_ACP)]
mapviewOptions(na.color = "transparent",
               basemaps="OpenStreetMap",
               viewer.suppress=TRUE,
               trim=TRUE)
r1 <- raster(paths_rast_ACP_axe1[grep("mai",paths_rast_ACP_axe1)])
m1 <- mapview(r1,layer.name="Axe 1 - Mai",col.regions=brewer.pal(5,"RdYlBu"))
r2 <- raster(paths_rast_ACP_axe1[grep("juin",paths_rast_ACP_axe1)])
m2 <- mapview(r2,layer.name="Axe 1 - Juin",col.regions=brewer.pal(5,"RdYlBu"))
r3 <- raster(paths_rast_ACP_axe1[grep("juillet",paths_rast_ACP_axe1)])
m3 <- mapview(r3,layer.name="Axe 1 - Juillet",col.regions=brewer.pal(5,"RdYlBu"))
r4 <- raster(paths_rast_ACP_axe1[grep("aout",paths_rast_ACP_axe1)])
m4 <- mapview(r4,layer.name="Axe 1 - Aout",col.regions=brewer.pal(5,"RdYlBu"))
r5 <- raster(paths_rast_ACP_axe1[grep("septembre",paths_rast_ACP_axe1)])
m5 <- mapview(r5,layer.name="Axe 1 - Septembre",col.regions=brewer.pal(5,"RdYlBu"))

## view different aspects of same data set
leafsync::sync(m1, m2, m3, m4, m5, ncol=5)
```

```{r, echo=FALSE,out.width="100%",fig.show='hold',message=FALSE,warning=FALSE}
paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/toutes/"),'.tif$',full.names = T,recursive=TRUE)

paths_rast_ACP_axe2 = paths_rast_ACP[grep("axe2_",paths_rast_ACP)]
mapviewOptions(na.color = "transparent",
               basemaps="OpenStreetMap",
               viewer.suppress=TRUE,
               trim=TRUE)
r1 <- raster(paths_rast_ACP_axe2[grep("mai",paths_rast_ACP_axe2)])
m1 <- mapview(r1,layer.name="Axe 2 - Mai",col.regions=brewer.pal(5,"Greens"))
r2 <- raster(paths_rast_ACP_axe2[grep("juin",paths_rast_ACP_axe2)])
m2 <- mapview(r2,layer.name="Axe 2 - Juin",col.regions=brewer.pal(5,"Greens"))
r3 <- raster(paths_rast_ACP_axe2[grep("juillet",paths_rast_ACP_axe2)])
m3 <- mapview(r3,layer.name="Axe 2 - Juillet",col.regions=brewer.pal(5,"Greens"))
r4 <- raster(paths_rast_ACP_axe2[grep("aout",paths_rast_ACP_axe2)])
m4 <- mapview(r4,layer.name="Axe 2 - Aout",col.regions=brewer.pal(5,"Greens"))
r5 <- raster(paths_rast_ACP_axe2[grep("septembre",paths_rast_ACP_axe2)])
m5 <- mapview(r5,layer.name="Axe 2 - Septembre",col.regions=brewer.pal(5,"Greens"))

## view different aspects of same data set
leafsync::sync(m1, m2, m3, m4, m5, ncol=5)
```

<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->
<!-- <br/> -->

Pourcentage de contribution des variables pour l'**axe 3** de l'AFDM.

```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
C3 = tout[grep("contrib_axe3",tout)]
include_graphics(c(C3[grep("mai",C3)],C3[grep("juin",C3)],
                   C3[grep("juillet",C3)],C3[grep("aout",C3)],
                   C3[grep("septembre",C3)]))
``` 

Distribution des variables quantitatives sur l'axe 2 et l'axe 3.

```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
DV = tout[grep("graph_var_quanti_axes2_3",tout)]
include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)],
                   DV[grep("juillet",DV)],DV[grep("aout",DV)],
                   DV[grep("septembre",DV)]))
``` 

Distribution des variables qualitatives sur l'axe 2 et l'axe 3.

```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
DV = tout[grep("graph_var_quali_axes2_3",tout)]
include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)],
                   DV[grep("juillet",DV)],DV[grep("aout",DV)],
                   DV[grep("septembre",DV)]))
``` 


* Axe 3 : décrit principalement par des variables appartenant à la dimension conditions abiotiques.  
Aux valeurs élevées de cet axe, on trouve des pixels qui présentent une pente forte, en face nord, dont la strate basse est peu pénétrable (lande à éricacées) et avec un feuillage moyennement abondant.  
Les valeurs faibles de cet axe se retrouvent aux pixels avec un rayonnement fort, un potentiel hydrique élevé et la présence de plan d'eau dans des reliefs ouverts.  
Il semblerait que cet axe distingue d'une part les pixels orientés nord, qu'ils soient forestiers ou à landes, à pente modérée à élevée, et d'autre part les lacs et la tourbière de l'Arselle.

```{r, echo=FALSE,out.width="100%",fig.show='hold',message=FALSE,warning=FALSE}
paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/toutes/"),'.tif$',full.names = T,recursive=TRUE)

paths_rast_ACP_axe3 = paths_rast_ACP[grep("axe3_",paths_rast_ACP)]
mapviewOptions(na.color = "transparent",
               basemaps="OpenStreetMap",
               viewer.suppress=TRUE,
               trim=TRUE)
r1 <- raster(paths_rast_ACP_axe3[grep("mai",paths_rast_ACP_axe3)])
m1 <- mapview(r1,layer.name="Axe 3 - Mai",col.regions=rev(brewer.pal(5,"Blues")))
r2 <- raster(paths_rast_ACP_axe3[grep("juin",paths_rast_ACP_axe3)])
m2 <- mapview(r2,layer.name="Axe 3 - Juin",col.regions=rev(brewer.pal(5,"Blues")))
r3 <- raster(paths_rast_ACP_axe3[grep("juillet",paths_rast_ACP_axe3)])
m3 <- mapview(r3,layer.name="Axe 3 - Juillet",col.regions=rev(brewer.pal(5,"Blues")))
r4 <- raster(paths_rast_ACP_axe3[grep("aout",paths_rast_ACP_axe3)])
m4 <- mapview(r4,layer.name="Axe 3 - Aout",col.regions=rev(brewer.pal(5,"Blues")))
r5 <- raster(paths_rast_ACP_axe3[grep("septembre",paths_rast_ACP_axe3)])
m5 <- mapview(r5,layer.name="Axe 3 - Septembre",col.regions=rev(brewer.pal(5,"Blues")))

## view different aspects of same data set
leafsync::sync(m1, m2, m3, m4, m5, ncol=5)
```
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>

Distribution des pixels sur l'axe 1 et l'axe 2.

```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
DI = tout[grep("graph_ind",tout)]
include_graphics(c(DI[grep("mai",DI)],DI[grep("juin",DI)],
                   DI[grep("juillet",DI)],DI[grep("aout",DI)],
                   DI[grep("septembre",DI)]))
``` 

<!-- Distribution des variables sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->


## Tableau récapitulatif des variables utilisées
```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE}
kable(table_variables)

``` 

<!-- # Analyse factorielle sur les axes des AFDM de toutes les dimensions {.tabset} -->
<!-- ## Graphiques -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- tout = list.files(recursive = T, paste0(wd,"/output/ACP/ACP_FAMD/"), full.names = T) -->
<!-- table_variables <- fread(path_table_variables, header=T) -->
<!-- ```  -->

<!-- |`        Mai          `|`          Juin         `|`          Juillet           `|`          Août          `|`          Septembre    `| -->
<!-- |----|----|----|----|----| -->
<!-- |` `|` `|` `|` `|` `| -->

<!-- Pourcentage de variance expliqué par les axes de l'ACP. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- eboulis = tout[grep("eboulis_variance",tout)] -->
<!-- include_graphics(c(eboulis[grep("mai",eboulis)],eboulis[grep("juin",eboulis)], -->
<!--                    eboulis[grep("juillet",eboulis)],eboulis[grep("aout",eboulis)], -->
<!--                    eboulis[grep("septembre",eboulis)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables pour l'**axe 1** de l'ACP. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C1 = tout[grep("contrib_axe1",tout)] -->
<!-- include_graphics(c(C1[grep("mai",C1)],C1[grep("juin",C1)], -->
<!--                    C1[grep("juillet",C1)],C1[grep("aout",C1)], -->
<!--                    C1[grep("septembre",C1)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables pour l'**axe 2** de l'ACP. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C2 = tout[grep("contrib_axe2",tout)] -->
<!-- include_graphics(c(C2[grep("mai",C2)],C2[grep("juin",C2)], -->
<!--                    C2[grep("juillet",C2)],C2[grep("aout",C2)], -->
<!--                    C2[grep("septembre",C2)])) -->
<!-- ```  -->

<!-- Pourcentage de contribution des variables pour l'**axe 3** de l'ACP. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- C3 = tout[grep("contrib_axe3",tout)] -->
<!-- include_graphics(c(C3[grep("mai",C3)],C3[grep("juin",C3)], -->
<!--                    C3[grep("juillet",C3)],C3[grep("aout",C3)], -->
<!--                    C3[grep("septembre",C3)])) -->
<!-- ```  -->

<!-- Distribution des pixels sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DI = tout[grep("graph_ind",tout)] -->
<!-- include_graphics(c(DI[grep("mai",DI)],DI[grep("juin",DI)], -->
<!--                    DI[grep("juillet",DI)],DI[grep("aout",DI)], -->
<!--                    DI[grep("septembre",DI)])) -->
<!-- ```  -->

<!-- Distribution des variables sur l'axe 1 et l'axe 2. -->

<!-- ```{r,out.width="20%",fig.show='hold', echo=FALSE, warning=FALSE} -->
<!-- DV = tout[grep("graph_var",tout)] -->
<!-- include_graphics(c(DV[grep("mai",DV)],DV[grep("juin",DV)], -->
<!--                    DV[grep("juillet",DV)],DV[grep("aout",DV)], -->
<!--                    DV[grep("septembre",DV)])) -->
<!-- ```  -->

<!-- ## Cartes {.tabset} -->

<!-- Cartes issues des ACPs sur les axes des FAMD. Les 3 axes des ACP ont été transformés entre 0 et 255, pour être codés en RGB. -->

<!-- ### Mai -->

<!-- ```{r, echo=FALSE,fig.align="center",message=FALSE,warning=FALSE} -->
<!-- paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/ACP_FAMD/05mai/"),'.tif$',full.names = T) -->
<!-- r <- stack(paths_rast_ACP) -->
<!-- mapviewOptions(na.color = "transparent", -->
<!--                basemaps="OpenStreetMap", -->
<!--                viewer.suppress=TRUE, -->
<!--                trim=TRUE) -->
<!-- viewRGB(r) -->
<!-- ``` -->

<!-- ### Juin -->

<!-- ```{r, echo=FALSE,fig.align="center",message=FALSE,warning=FALSE} -->
<!-- paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/ACP_FAMD/06juin/"),'.tif$',full.names = T) -->
<!-- r <- stack(paths_rast_ACP) -->
<!-- mapviewOptions(na.color = "transparent", -->
<!--                basemaps="OpenStreetMap", -->
<!--                viewer.suppress=TRUE, -->
<!--                trim=TRUE) -->
<!-- viewRGB(r) -->
<!-- ``` -->

<!-- ### Juillet -->
<!-- ```{r, echo=FALSE,fig.align="center",message=FALSE,warning=FALSE} -->
<!-- paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/ACP_FAMD/07juillet/"),'.tif$',full.names = T) -->
<!-- r <- stack(paths_rast_ACP) -->
<!-- mapviewOptions(na.color = "transparent", -->
<!--                basemaps="OpenStreetMap", -->
<!--                viewer.suppress=TRUE, -->
<!--                trim=TRUE) -->
<!-- viewRGB(r) -->
<!-- ``` -->
<!-- ### Août -->
<!-- ```{r, echo=FALSE,fig.align="center",message=FALSE,warning=FALSE} -->
<!-- paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/ACP_FAMD/08aout/"),'.tif$',full.names = T) -->
<!-- r <- stack(paths_rast_ACP) -->
<!-- mapviewOptions(na.color = "transparent", -->
<!--                basemaps="OpenStreetMap", -->
<!--                viewer.suppress=TRUE, -->
<!--                trim=TRUE) -->
<!-- viewRGB(r) -->
<!-- ``` -->

<!-- ### Septembre -->
<!-- ```{r, echo=FALSE,fig.align="center",message=FALSE,warning=FALSE} -->
<!-- paths_rast_ACP <- list.files(paste0(wd,"/output/ACP/ACP_FAMD/09septembre/"),'.tif$',full.names = T) -->
<!-- r <- stack(paths_rast_ACP) -->
<!-- mapviewOptions(na.color = "transparent", -->
<!--                basemaps="OpenStreetMap", -->
<!--                viewer.suppress=TRUE, -->
<!--                trim=TRUE) -->
<!-- viewRGB(r) -->
<!-- ``` -->
